ALTER TABLE REGION ADD R_REGIONSID INTEGER;
SET @n = 0;
SET SQL_SAFE_UPDATES = 0;
UPDATE REGION SET R_REGIONSID = @n := @n + 1;
CREATE TABLE NATION_ALIGNED AS SELECT R_REGIONSID AS N_REGIONSID, NATION.* FROM REGION RIGHT JOIN NATION ON NATION.N_REGIONKEY = REGION.R_REGIONKEY ORDER BY N_REGIONSID;
ALTER TABLE NATION_ALIGNED ADD N_NATIONSID INTEGER;
SET @n = 0;
SET SQL_SAFE_UPDATES = 0;
UPDATE NATION_ALIGNED SET N_NATIONSID = @n := @n + 1;
ALTER TABLE NATION_ALIGNED ADD PRIMARY KEY (N_NATIONKEY);
CREATE TABLE CUSTOMER_ALIGNED AS SELECT N_NATIONSID AS C_NATIONSID, CUSTOMER.* FROM NATION_ALIGNED RIGHT JOIN CUSTOMER ON CUSTOMER.C_NATIONKEY = NATION_ALIGNED.N_NATIONKEY ORDER BY C_NATIONSID;
ALTER TABLE CUSTOMER_ALIGNED ADD C_CUSTSID INTEGER;
SET @n = 0;
SET SQL_SAFE_UPDATES = 0;
UPDATE CUSTOMER_ALIGNED SET C_CUSTSID = @n := @n + 1;
ALTER TABLE CUSTOMER_ALIGNED ADD PRIMARY KEY (C_CUSTKEY);
CREATE TABLE ORDERS_ALIGNED AS SELECT C_CUSTSID AS O_CUSTSID, ORDERS.* FROM CUSTOMER_ALIGNED RIGHT JOIN ORDERS ON CUSTOMER_ALIGNED.C_CUSTKEY= ORDERS.O_CUSTKEY ORDER BY O_CUSTSID;
ALTER TABLE ORDERS_ALIGNED ADD O_ORDERSID INTEGER;
SET @n = 0;
SET SQL_SAFE_UPDATES = 0;
UPDATE ORDERS_ALIGNED SET O_ORDERSID = @n := @n + 1;
ALTER TABLE ORDERS_ALIGNED ADD PRIMARY KEY (O_ORDERKEY);
CREATE TABLE LINEITEM_ALIGNED AS SELECT O_ORDERSID AS L_ORDERSID, LINEITEM.* FROM ORDERS_ALIGNED RIGHT JOIN LINEITEM ON ORDERS_ALIGNED.O_ORDERKEY = LINEITEM.L_ORDERKEY ORDER BY L_ORDERSID;
ALTER TABLE LINEITEM_ALIGNED ADD PRIMARY KEY (L_ORDERKEY, L_LINENUMBER);
CREATE TABLE SUPPLIER_ALIGNED AS SELECT N_NATIONSID AS S_NATIONSID, SUPPLIER.* FROM NATION_ALIGNED RIGHT JOIN SUPPLIER ON NATION_ALIGNED.N_NATIONKEY= SUPPLIER.S_NATIONKEY ORDER BY S_NATIONSID;
ALTER TABLE SUPPLIER_ALIGNED ADD S_SUPPSID INTEGER;
SET @n = 0;
SET SQL_SAFE_UPDATES = 0;
UPDATE SUPPLIER_ALIGNED SET S_SUPPSID = @n := @n + 1;
ALTER TABLE SUPPLIER_ALIGNED ADD PRIMARY KEY (S_SUPPKEY);
CREATE TABLE PARTSUPP_ALIGNED AS SELECT S_SUPPSID AS PS_SUPPSID, PARTSUPP.*  FROM SUPPLIER_ALIGNED RIGHT JOIN PARTSUPP ON  PARTSUPP.PS_SUPPKEY = SUPPLIER_ALIGNED.S_SUPPKEY ORDER BY PS_SUPPSID;
ALTER TABLE PARTSUPP_ALIGNED ADD PRIMARY KEY (PS_PARTKEY, PS_SUPPKEY);